---
title: 同步与异步阻塞与非阻塞的作用及区别
date: 2018-04-04 15:42:06
tags: I/O
categories: 
---

这篇文章主要介绍了同步([synchronous](http://www.iciba.com/synchronous))异步([asynchronous](http://www.iciba.com/asynchronous))

阻塞(blocking) 非阻塞(non-blocking)它们之间的联系和区别，作记录用，如有错误还请告知。

1. 在介绍之前我们首先要了解一个概念：**I/O**(Input/Output)

对于I/O没有明确的定义而言，它取决于所处系统以及从哪个视角看待，是从用户，进程，还是内核的角度看待I/O呢

- 如果从进程的角度看的话，可以说Linux下的一个I/O操作就是用来读写系统服务的，从这个意义上来说打开一个文件就不是I/O操作，因为它并没有读写进程中的数据。
- 但是如果是从内核的角度看待，打开文件需要读取一个或多个目录的内容并且读取硬盘里的头文件信息，因此任何在硬盘和内存之间的数据改变都可以被视作I/O操作
- 从一个用户的角度来说，I/O操作就是在处理器中读入或者读出数据。就我上面提到的而言,通过更新显存，计算机可以将内容写入到屏幕上，人们可能会在主存与显存之间进行区分，但从逻辑上来说，并不存在真正的数据移动。

简而言之，决定一个操作是不是I/O操作取决于所处的视角。

2. 同步异步阻塞非阻塞用来干嘛的呢？

**同步与异步阻塞与非阻塞的作用：就是I/O操作时的工作模式 （I/O Models）**

其中**同步和异步的区别**是的是I/O操作中交互（消息通信）机制的不同

- 同步：调用者会主动等待调用结果
- 异步：调用者发起一个异步调用，然后立即返回去做别的事。“被调用者”通过状态、通知、回调函数都手段来通知“调用者”。异步IO不是FIFO有序的，例如进程A与进程B先后对一个端口发起了异步读操作，有可能是进程B先得到读操作的结果。

而**阻塞和非阻塞的区别**主要是调用者”线程在等待调用结果时的状态

- 阻塞：线程被操作系统挂起

- 非阻塞：线程不被操作系统挂起，可以处理其他的事情

  > 在处理 IO 的时候，阻塞和非阻塞都是同步 IO。
  >
  > 只有使用了特殊的 API 才是异步 IO。

  > 对unix来讲：阻塞式I/O(默认)，非阻塞式I/O(nonblock)，I/O复用(select/poll/epoll)都属于同步I/O，因为它们在数据由内核空间复制回进程缓冲区时都是阻塞的(不能干别的事)。只有异步I/O模型(AIO)是符合异步I/O操作的含义的，即在1数据准备完成、2由内核空间拷贝回缓冲区后 通知进程，在等待通知的这段时间里可以干别的事。

用一个生活中的例子来说明

>老张爱喝茶，废话不说，煮开水。

> 出场人物：老张，水壶两把（普通水壶，简称水壶；会响的水壶，简称响水壶）。
> 1 老张把水壶放到火上，立等水开。（同步阻塞）
> 老张觉得自己有点傻
> 2 老张把水壶放到火上，去客厅看电视，时不时去厨房看看水开没有。（同步非阻塞）
> 老张还是觉得自己有点傻，于是变高端了，买了把会响笛的那种水壶。水开之后，能大声发出嘀~~~~的噪音。
> 3 老张把响水壶放到火上，立等水开。（异步阻塞）
> 老张觉得这样傻等意义不大
> 4 老张把响水壶放到火上，去客厅看电视，水壶响之前不再去看它了，响了再去拿壶。（异步非阻塞）
> 老张觉得自己聪明了。
>
> 所谓同步异步，只是对于水壶而言。
> 普通水壶，同步；响水壶，异步。
> 虽然都能干活，但响水壶可以在自己完工之后，提示老张水开了。这是普通水壶所不能及的。
> 同步只能让调用者去轮询自己（情况2中），造成老张效率的低下。
>
> 所谓阻塞非阻塞，仅仅对于老张而言。
> 立等的老张，阻塞；看电视的老张，非阻塞。
> 情况1和情况3中老张就是阻塞的，媳妇喊他都不知道。虽然3中响水壶是异步的，可对于立等的老张没有太大的意义。所以一般异步是配合非阻塞使用的，这样才能发挥异步的效用。
>
> ——来源网络，作者不明。

参考资料：

[What is the definition of I/O, and what actions are classified as I/O?](https://stackoverflow.com/questions/41477425/what-is-the-definition-of-i-o-and-what-actions-are-classified-as-i-o)

[I/O维基百科定义](https://zh.wikipedia.org/wiki/I/O)

[怎样理解阻塞非阻塞与同步异步的区别？](https://www.zhihu.com/question/19732473)

[I/O多路复用技术（multiplexing）是什么？](https://www.zhihu.com/question/28594409)

